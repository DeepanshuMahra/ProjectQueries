--cleaning data in sql queries

select * from
project..sheetnashhousing

--date format
select SALEDATECONVERTED,convert(date,SaleDate) as SALEDATE
from project..sheetnashhousing

update sheetnashhousing
set SALEDATECONVERTED = convert(date,SaleDate);

select * from
project..sheetnashhousing

ALTER TABLE sheetnashhousing
add SALEDATECONVERTED date;


--Populate Property Address

select *
from project..sheetnashhousing
where PropertyAddress is null
order by ParcelID


select a.ParcelID,a.PropertyAddress,b.ParcelID,b.PropertyAddress,isnull(a.PropertyAddress,b.PropertyAddress)
from project..sheetnashhousing a
join project..sheetnashhousing b
on a.ParcelID = b.ParcelID
and a.[UniqueID ]<> b.[UniqueID ]
Where a.PropertyAddress is null


update a
set PropertyAddress = isnull(a.PropertyAddress,b.PropertyAddress) ---Removed all null values
from project..sheetnashhousing a
join project..sheetnashhousing b
on a.ParcelID = b.ParcelID
and a.[UniqueID ]<> b.[UniqueID ]
where a.PropertyAddress is null


------breaking out address into individual column (Address,city,state)             SPLIT
select propertyaddress
from sheetnashhousing


select SUBSTRING(propertyaddress,1,charindex(',',propertyaddress)-1) as Address,
 SUBSTRING(propertyaddress,charindex(',',propertyaddress)+1 ,len(propertyaddress))as Address
from sheetnashhousing


alter table project..sheetnashhousing
add PropertySplitAddress nvarchar(50)

update sheetnashhousing
set PropertySplitAddress = SUBSTRING(propertyaddress,1,charindex(',',propertyaddress)-1)



alter table project..sheetnashhousing
add PropertySplitCity nvarchar(50)


update sheetnashhousing
set PropertySplitCity = SUBSTRING(propertyaddress,charindex(',',propertyaddress)+1,len(propertyaddress))



select PropertySplitCity,PropertySplitAddress
from Project..sheetnashhousing


--owner address

select OwnerAddress
from Project..sheetnashhousing



select
PARSENAME(replace(OwnerAddress,',','.'),3),
PARSENAME(replace(OwnerAddress,',','.'),2),
PARSENAME(replace(OwnerAddress,',','.'),1)
from Project..sheetnashhousing




alter table project..sheetnashhousing
add ownerSplitAddress nvarchar(50)


update sheetnashhousing
set OwnerSplitAddress = PARSENAME(replace(OwnerAddress,',','.'),3)

alter table project..sheetnashhousing
add OwnerSplitCity nvarchar(50)


update sheetnashhousing
set OwnerSplitCity = PARSENAME(replace(OwnerAddress,',','.'),2)


alter table project..sheetnashhousing
add OwnerSplitState nvarchar(50)


update sheetnashhousing
set OwnerSPlitState = PARSENAME(replace(OwnerAddress,',','.'),1)


select * from Project..sheetnashhousing



--Change y to Yes and n  to no in "sold as vacant" field

select distinct (SoldAsVacant),count(SoldAsVacant)
from Project..sheetnashhousing
group by SoldAsVacant
order by 2


select SoldAsVacant
,case when SoldAsVacant = 'Y'then 'Yes'
 when SoldAsVacant = 'N'then 'No'
 else SoldAsVacant
end
from Project..sheetnashhousing

update sheetnashhousing
set SoldAsVacant = case when SoldAsVacant = 'Y'then 'Yes'
 when SoldAsVacant = 'N'then 'No'
 else SoldAsVacant
end

--Remove duplicates

select * 
from Project..sheetnashhousing

WITH RowNumCTE AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY parcelid, propertyaddress, SalePrice, SaleDate, LegalReference ORDER BY UniqueId) AS row_num
    FROM Project..sheetnashhousing
)

select * from RowNumCte
where row_num > 1
order by PropertyAddress


WITH RowNumCTE AS (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY parcelid, propertyaddress, SalePrice, SaleDate, LegalReference ORDER BY UniqueId) AS row_num
    FROM Project..sheetnashhousing
)
select *
from RowNumCTE
where row_num > 1


---Delete Unused Column
select *
from Project..sheetnashhousing


Alter Table sheetnashhousing
drop column OwnerAddress,taxDistrict,propertyAddress,saledate








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































